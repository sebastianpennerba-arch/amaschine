<!DOCTYPE html>
<html>
<head><title>Meta Auth</title></head>
<body>
<script>
const params = new URLSearchParams(window.location.search);
const code = params.get("code");

if (!code) {
    window.close();
}

// Code an Backend schicken â†’ Access Token holen
fetch(`/api/meta-auth?code=${code}`)
  .then(res => res.json())
  .then(json => {
      if (json.access_token) {
          // An Dashboard schicken
          window.opener.postMessage(
              { access_token: json.access_token },
              "*"
          );
      } else {
          window.opener.postMessage(
              { error: "token_failed" },
              "*"
          );
      }
      window.close();
  });
</script>

<p>Meta Login erfolgreich. Dieses Fenster kann geschlossen werden.</p>
</body>
</html>
